<?xml version="1.0" encoding="UTF-8"?><record_update table="sysauto_script">
    <sysauto_script action="INSERT_OR_UPDATE">
        <active>false</active>
        <business_calendar/>
        <condition/>
        <conditional>false</conditional>
        <entered_time>1970-01-01 01:00:00</entered_time>
        <name>Sync Badge Templates</name>
        <run_as/>
        <run_as_tz/>
        <run_dayofmonth>1</run_dayofmonth>
        <run_dayofweek>1</run_dayofweek>
        <run_period/>
        <run_start>2020-11-26 13:18:43</run_start>
        <run_time>1970-01-01 01:00:00</run_time>
        <run_type>daily</run_type>
        <script><![CDATA[getTemplate();

function getTemplate() {
    try {
        gs.info("Get Template   :: begin ");
        var r = new sn_ws.RESTMessageV2('x_aleen_badgeoff.GetJWTToken', 'POST');
        var response = r.execute();
        var responseBody = response.getBody();
        var httpStatus = response.getStatusCode();
        var Token = null;
        var responseObj = JSON.parse(responseBody);
        if (null != responseObj && responseObj.success && null != responseObj.data) {
            Token = responseObj.data.access_token;
        }
        if (null != Token) {
            gs.info("Got the Token");
            var templateRequest = new sn_ws.RESTMessageV2('x_aleen_badgeoff.GetBadgeTemplateFromAlertEnterprise', 'POST');
            templateRequest.setStringParameterNoEscape('Token', Token);
            var templateResponse = templateRequest.execute();
            var templateResponseBody = templateResponse.getBody();
            var templateResponseStatus = templateResponse.getStatusCode();
            var templateResponseObject = JSON.parse(templateResponseBody);
            if (null != templateResponseObject && templateResponseObject.success) {
                var rec = new GlideRecordSecure('x_aleen_badgeoff_configuration');
                rec.query();
                while (rec.next()) {
                    rec.setValue('front_side_template', templateResponseObject.data[0].frontSideBadgeHTML);
                    rec.setValue('back_side_template', templateResponseObject.data[0].backSideBadgeHTML);
                    gs.info('x_aleen_badgeoff_configuration');
                    rec.update();
                }
            }
        }
    } catch (ex) {
        var message = ex.message;
    }
}]]></script>
        <sys_class_name>sysauto_script</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-11-26 13:55:03</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>6545b5dcdb306c10c34541deaa9619d9</sys_id>
        <sys_mod_count>6</sys_mod_count>
        <sys_name>Sync Badge Templates</sys_name>
        <sys_package display_value="AE Badge Office" source="x_aleen_badgeoff">45d0a9d8dbfc2c10c34541deaa961990</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="AE Badge Office">45d0a9d8dbfc2c10c34541deaa961990</sys_scope>
        <sys_update_name>sysauto_script_6545b5dcdb306c10c34541deaa9619d9</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2021-01-07 16:28:36</sys_updated_on>
        <time_zone>GMT</time_zone>
        <upgrade_safe>false</upgrade_safe>
    </sysauto_script>
</record_update>
